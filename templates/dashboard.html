{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold text-dark mb-0">Dashboard Overview</h3>
    <span class="badge bg-white text-secondary shadow-sm p-2"><i class="fa-solid fa-calendar me-2"></i> Hari Ini</span>
</div>

<div class="row g-4 mb-4">
    <div class="col-xl-3 col-md-6">
        <div class="card h-100 border-start border-4 border-primary shadow-sm hover-effect">
            <div class="card-body d-flex align-items-center justify-content-between">
                <div>
                    <p class="text-muted mb-1 small fw-bold text-uppercase">Total Debit</p>
                    <h5 class="fw-bold text-dark mb-0">Rp {{ "{:,.0f}".format(t_debit) }}</h5>
                </div>
                <div class="bg-primary bg-opacity-10 p-3 rounded text-primary fs-4">
                    <i class="fa-solid fa-arrow-trend-up"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card h-100 border-start border-4 border-danger shadow-sm hover-effect">
            <div class="card-body d-flex align-items-center justify-content-between">
                <div>
                    <p class="text-muted mb-1 small fw-bold text-uppercase">Total Kredit</p>
                    <h5 class="fw-bold text-dark mb-0">Rp {{ "{:,.0f}".format(t_kredit) }}</h5>
                </div>
                <div class="bg-danger bg-opacity-10 p-3 rounded text-danger fs-4">
                    <i class="fa-solid fa-arrow-trend-down"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card h-100 border-start border-4 border-warning shadow-sm hover-effect">
            <div class="card-body d-flex align-items-center justify-content-between">
                <div>
                    <p class="text-muted mb-1 small fw-bold text-uppercase">Total Akun</p>
                    <h5 class="fw-bold text-dark mb-0">{{ t_akun }} Akun</h5>
                </div>
                <div class="bg-warning bg-opacity-10 p-3 rounded text-warning fs-4">
                    <i class="fa-solid fa-folder-open"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="col-xl-3 col-md-6">
        <div class="card h-100 border-start border-4 border-success shadow-sm hover-effect">
            <div class="card-body d-flex align-items-center justify-content-between">
                <div>
                    <p class="text-muted mb-1 small fw-bold text-uppercase">Volume Transaksi</p>
                    <h5 class="fw-bold text-dark mb-0">{{ t_transaksi }} Baris</h5>
                </div>
                <div class="bg-success bg-opacity-10 p-3 rounded text-success fs-4">
                    <i class="fa-solid fa-receipt"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <div class="col-lg-8">
        <div class="card h-100 shadow-sm">
            <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center">
                <h6 class="m-0 fw-bold text-primary">Tren Arus Kas (7 Hari Terakhir)</h6>
                <i class="fa-solid fa-ellipsis-vertical text-muted"></i>
            </div>
            <div class="card-body">
                <canvas id="lineChart" height="120"></canvas>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card h-100 shadow-sm">
            <div class="card-header bg-white py-3">
                <h6 class="m-0 fw-bold text-primary">Komposisi Beban</h6>
            </div>
            <div class="card-body d-flex align-items-center justify-content-center">
                <canvas id="pieChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
    // Styling Font Global Chart
    Chart.defaults.font.family = "'Poppins', sans-serif";
    Chart.defaults.color = '#858796';

    // 1. Line Chart Config
    new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: {
            labels: {{ line_labels|safe }},
            datasets: [{
                label: 'Net Cash Flow',
                data: {{ line_values|safe }},
                borderColor: '#005eb8',
                backgroundColor: 'rgba(0, 94, 184, 0.05)',
                pointBackgroundColor: '#fff',
                pointBorderColor: '#005eb8',
                pointHoverBackgroundColor: '#005eb8',
                pointHoverBorderColor: '#fff',
                fill: true,
                tension: 0.4,
                borderWidth: 2
            }]
        },
        options: {
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: {
                x: { grid: { display: false } },
                y: { grid: { borderDash: [5, 5], color: '#e3e6f0' } }
            }
        }
    });

    // 2. Pie Chart Config
    new Chart(document.getElementById('pieChart'), {
        type: 'doughnut',
        data: {
            labels: {{ pie_labels|safe }},
            datasets: [{
                data: {{ pie_values|safe }},
                backgroundColor: ['#4e73df', '#1cc88a', '#36b9cc', '#f6c23e', '#e74a3b'],
                hoverOffset: 4
            }]
        },
        options: {
            maintainAspectRatio: false,
            cutout: '75%',
            plugins: {
                legend: { position: 'bottom', labels: { usePointStyle: true, padding: 20 } }
            }
        }
    });
</script>

<style>
    /* Efek Hover Sedikit Naik agar Interaktif */
    .hover-effect { transition: transform 0.2s; }
    .hover-effect:hover { transform: translateY(-5px); }
</style>
{% endblock %}